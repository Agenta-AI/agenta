---
title: "Pattern Matching Evaluation"
---

Text Classification and Entity Extraction are fundamental tasks in natural language processing (NLP) which involves the categorization of text into predefined classes
and identifying specific entities within the text, such as names, dates, or locations. In Agenta, these tasks can be efficiently handled using evaluators
that check for exact matches or perform detailed comparisons on structured data.

This guide will walk you through how to use the Exact Match evaluator and the JSON-based Evaluators within Agenta.

# Exact Match

The Exact Match evaluator checks if the model's generated output perfectly aligns with the expected result.

In other words, what this evaluator does it that it compares the model's response to a predefined correct answer and determines if they are identical.
This is a straightforward way to measure precision and ensure that your model is giving the exact responses you need.

## Using the Exact Match Evaluator in Agenta

The first step is to create or import a [testset](/evaluation/test_sets) into Agenta that will serve as the benchmark dataset.
This guide will use a dataset containing countries and their capitals.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-Exact-match-testset.png"
/>

Proceed to the **Automatic Evaluations** section in the sidebar and click the **New Evaluations** button.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-Exact-Match-select.png"
/>

Select the **Exact Match** evaluator.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-Exact-match-menu-select.png"
/>

Assign a **name** to this evaluator and add the column's name in the test data containing the ground truth, in this case, the `correct_answer` column.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-Exact-match-search-add-name.png"
/>

Click **Save** and proceed to the **Result** section.

Click the **New Evaluation** button and fill in the required data, such as the test set you want to use the variants you would like to evaluate, and
the evaluator you would like to evaluate (in this case Exact Match).

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-Exact-match-Create-Evaluator.png"
/>

For advanced configuration, toggle on the Advanced configuration button and set the following:

- Batch size ( Number of testset to have in each batch )
- Max retries ( Maximum number of times to retry the failed llm call )
- Retry delay ( Delay before retrying the failed llm call (in seconds) )
- Delay between batches ( Delay to run batches (in seconds) )
- Correct answer column ( Column in the test set containing the correct/expected answer )

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-Exact-match-Advanced-config.png"
/>

Click on the **create** button while you wait for the Exact Match evaluator to run.
Once completed, you will be able to see the Exact Match result (**True of False**) and other metrics, such as cost and latency.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-Exact-match-Evaluation-result.png"
/>

# JSON-based Evaluators

In Agenta, there are three evaluators who perform JSON-based evaluations: contains JSON, JSON field match, and JSON diff score.
Let's take a look at how to use these evaluators to evaluate the model's response.

## Contains Json

This evaluator checks if the model's output contains contains the specified JSON structure.
It can be quite useful when you need to confirm that certain keys and values are present in the output, ensuring that essential data elements are included.

In the **Evaluators section**, click on **New Evaluator** and select **Contains JSON Evaluator**

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation-contain_JSON_select.png"
/>

Give it a name and hit **Save**.

Navigate to the **Results** section and click on **New Evaluation**. Once you see the pop up, fill in fields such as the test set you want to use? the variants you would like to evaluate, and
which evaluators would you like to evaluate (in this case Contains JSON Evaluator)?

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation-contain_JSON_new_evaluation.png"
/>

Similar to the Exact Match evaluator, you can configure the advanced configurations such as the Batch size, Max retries, Retry delay, and Delay between batches.
Then wait for the evaluator to run. The result is displayed in a table containing the input, output and the boolen (True / False) result of the evaluation.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation-contain_JSON_contains_json_result.png"
/>

## JSON Field Match

The JSON Field Match evaluator compares specific fields within JSON data.
This means that you have the ability to focus on particular fields in the JSON and ensures that they match the expected values.

In the **Evaluators section**, click on **New Evaluator** and select **Contains JSON Field Match**

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation_JSON_Field_Match.png"
/>

Add name and the JSON field (this is the name of the field in the JSON output that you wish to evaluate) in this case we want to match the field with the key `record`
to one column in the test set. Click **Save**.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation_JSON_Field_Match_Evaluator.png"
/>

In the **Results** section, create a **New Evaluation**, add your the testset do you want to use, the variants you would like to evaluate, and the evaluators you would like to evaluate on.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation_JSON_Field_Match_New_Evaluation.png"
/>

Then wait for the evaluator to run. The result is displayed in the table as shown below. You should note that the evaluator picked up the record in the test set with a `record` key, and the model's response matches that of the ground truth, giving us a **True** response.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation_JSON_Field_Match_Evaluation_Result.png"
/>

## JSON Diff Match

The JSON Diff Match evaluator compares the generated JSON output to a ground truth JSON and returns a normalized score between 0 and 1 based on their differences.
It provides a quantitative measure of how close the output JSON is to the expected result, considering all differences.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation_JSON_Diff_Match.png"
/>

Create a New Evaluation, give it a name and for addition configuration you can toggle the following:

- **Compare Schema Only**: If set to True, only the key names and their types will be compared between prediction and ground truth, ignoring the actual values. If set to False, key names, their types, and their values will all compared.
- **Include prediction keys**: If set to True, only keys present in the ground truth will be considered. The result will be 1.0 if a key from the ground truth is correctly predicted, regardless of any additional predicted keys. Otherwise both ground truth and prediction keys will be checked.
- **Enable Case-sensitive keys**: If set to True, keys will be treated as case-insensitive, meaning "key", "Key", and "KEY" are considered equivalent. Otherwise, keys will be treated as case-sensitive.
- **Expected Answer Column**: The name of the column in the test data that contains the correct answer

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation_JSON_Diff_Match_configuration.png"
/>

Click **Save**.

Create a **New Evaluation**, and fill in the field such as the testset do you want to use, the variants you would like to evaluate and finally the evaluator you would like to evaluate on.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation_JSON_Diff_Match_New_Evaluation.png"
/>

Click **Create**.

The evaluation runs and it is completed. The result is displayed in the table as shown below.

<img
  className="dark:hidden"
  height="600"
  src="/images/Evaluators/Agenta-JSON-Evaluation_JSON_Diff_Match_Result.png"
/>
